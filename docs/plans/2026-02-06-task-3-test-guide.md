# 任务 3: 页面级卡片联动 - 测试指南

**日期:** 2026-02-06
**任务:** 测试汇率卡片到账本卡片的联动功能

---

## 测试环境

- **本地服务器:** http://localhost:3000
- **状态:** ✅ 运行中
- **编译状态:** ✅ 成功 (无错误)

---

## 快速测试步骤

### 1. 基本联动测试 (最简单)

**步骤:**
1. 打开浏览器访问 http://localhost:3000
2. 等待页面加载完成 (默认在汇率卡片)
3. 观察汇率区域,等待汇率加载成功
4. 查看是否出现粉红色的"记一笔"按钮
5. 点击"记一笔"按钮
6. 观察页面是否自动滑动切换到账本卡片
7. 检查是否自动打开"添加交易记录"modal

**预期结果:**
- ✅ 汇率加载成功后显示"记一笔"按钮
- ✅ 点击后页面滑动到账本卡片
- ✅ Modal 自动弹出
- ✅ Modal 中显示正确的汇率

---

### 2. 按钮自动消失测试

**步骤:**
1. 刷新页面
2. 等待汇率加载成功
3. 观察"记一笔"按钮
4. 不点击按钮,等待 5 秒
5. 观察按钮是否自动消失

**预期结果:**
- ✅ 按钮在 5 秒后自动消失
- ✅ 消失时有动画效果

---

### 3. Modal 关闭后状态清理测试

**步骤:**
1. 执行基本联动测试,打开 modal
2. 在 modal 中点击"取消"按钮
3. 观察页面仍然在账本卡片
4. 手动滑动回到汇率卡片 (向右滑动)
5. 再次点击"记一笔"按钮
6. 观察是否能正常打开 modal

**预期结果:**
- ✅ Modal 关闭后状态正确清理
- ✅ 再次点击"记一笔"能正常工作
- ✅ 无重复或异常行为

---

### 4. 无旅行设置时的行为测试

**步骤:**
1. 打开浏览器开发者工具 (F12)
2. 在 Console 中执行:
   ```javascript
   localStorage.clear()
   ```
3. 刷新页面
4. 点击"记一笔"按钮
5. 观察行为

**预期结果:**
- ✅ 切换到账本卡片
- ✅ 不打开 modal (因为无设置)
- ✅ 显示"开始您的旅行"提示

---

### 5. 汇率传递验证测试

**步骤:**
1. 执行基本联动测试
2. 在 modal 的金额输入框中输入金额 (例如: 10000 KRW)
3. 观察是否显示人民币转换金额

**预期结果:**
- ✅ 输入韩元后自动计算人民币
- ✅ 汇率值与汇率卡片中显示的一致
- ✅ 转换计算正确

---

## 手动测试清单

请按以下顺序测试:

### 基础功能
- [ ] 汇率加载成功
- [ ] "记一笔"按钮显示
- [ ] 点击按钮切换到账本卡片
- [ ] Modal 自动打开
- [ ] 汇率正确传递

### 动画效果
- [ ] 按钮从底部滑入动画
- [ ] 页面切换滑动动画
- [ ] Modal 打开缩放动画
- [ ] 按钮自动消失动画

### 边界情况
- [ ] 按钮在 5 秒后自动消失
- [ ] Modal 关闭后状态清理
- [ ] 再次点击按钮正常工作
- [ ] 无设置时不打开 modal

### 用户体验
- [ ] 点击按钮后立即隐藏
- [ ] 切换动画流畅无卡顿
- [ ] Modal 打开时机恰当
- [ ] 汇率数据准确显示

---

## 已知问题和注意事项

### 当前限制
1. **需要先设置旅行信息**
   - 如果首次使用,需要先点击"设置旅行"
   - 设置后才能正常添加记录

2. **汇率时效性**
   - 传递的是当前查询的汇率
   - 如果延迟添加,汇率可能变化
   - 建议及时添加记录

### 测试提示
- 如果看不到"记一笔"按钮,刷新页面重试
- 确保 network 连接正常,汇率需要从 API 获取
- 如果 modal 没打开,检查是否已设置旅行信息

---

## 成功标准

### 必须满足
- ✅ 点击"记一笔"按钮能切换到账本卡片
- ✅ Modal 能自动打开
- ✅ 汇率数据正确传递
- ✅ 无控制台错误

### 额外加分
- ✅ 动画流畅自然
- ✅ 状态清理正确
- ✅ 用户体验良好

---

## 测试报告模板

完成测试后,请记录:

```
测试日期: ___________
测试人员: ___________

基础功能:
- [ ] 通过 / [ ] 失败
- 备注: ___________

动画效果:
- [ ] 通过 / [ ] 失败
- 备注: ___________

边界情况:
- [ ] 通过 / [ ] 失败
- 备注: ___________

整体评价:
- 评分: ___ / 10
- 建议: ___________
```

---

**文档版本:** 1.0
**最后更新:** 2026-02-06
